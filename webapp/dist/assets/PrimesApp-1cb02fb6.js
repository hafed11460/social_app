import{g as C,r as n,h as k,j as e,B as p,F as R,M as m,i as s,R as L,C as N,E as v,k as F,m as q,n as w,o as U,p as T,q as I,t as V,v as K,w as Q,P as D,x as A,y as M,z,A as Y,G as J,H as W,I as _,S as X,J as Z,K as ee,Q as se,T as O,U as te,V as re,W as ae,X as ne,Y as le,Z as ie,_ as ce,$ as de,a0 as oe,a1 as me,a2 as xe,a3 as he,L as je,a4 as ue,a5 as pe,a6 as be,a7 as fe,a8 as H}from"./index-15df89a0.js";import{N as G}from"./Nav-e002b58a.js";const ge={name:"Proces N°",observation:""},ye=()=>{const a=C(),[r,t]=n.useState(!1),[l,h]=n.useState(),{register:i,handleSubmit:b,formState:{errors:x}}=k({mode:"onBlur",defaultValues:ge}),u=async d=>{a(U(d)).unwrap().then(()=>{t(!1)}).catch(j=>{console.log(j),h(j.error)})};return e.jsxs(e.Fragment,{children:[e.jsx(p,{title:"Ajoute Proces",variant:"success",className:"rounded-0 mx-2",onClick:()=>t(!r),children:e.jsx(R,{})}),e.jsx(m,{show:r,size:"lg",onHide:()=>t(!1),centered:!0,"aria-labelledby":"contained-modal-title-vcenter",className:"form-vertical",children:e.jsxs(s,{onSubmit:b(u),children:[e.jsx(m.Header,{children:e.jsx("h4",{className:"card-title",children:" Create  Proces Verbal"})}),e.jsxs(m.Body,{children:[l&&e.jsx("p",{className:"text-danger",children:l}),e.jsxs(L,{children:[e.jsxs(s.Group,{as:N,className:"mb-3",children:[e.jsx(s.Label,{children:"Name"}),e.jsx(s.Control,{type:"text",...i("name",{required:"This Feild Is required"})}),e.jsx(v,{name:"name",error:l}),x.name&&e.jsx(s.Text,{className:"text-danger",children:x.name.message})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:F}),e.jsx(s.Control,{as:"textarea",rows:3,...i("observation")}),e.jsx(v,{name:"observation",error:l}),x.observation&&e.jsx(s.Text,{className:"text-danger",children:x.observation.message})]})]})]}),e.jsxs(m.Footer,{children:[e.jsx(p,{size:"sm",variant:"light",onClick:()=>t(!r),children:q}),e.jsx(p,{size:"sm",type:"submit",children:w})]})]})})]})},Ne=()=>{const a=T(I),r=C(),[t,l]=n.useState(!1),[h,{data:i,isLoading:b}]=V(),[x,{data:u}]=K({}),[d,j]=n.useState(),{register:g,handleSubmit:y,getValues:E,setValue:P,formState:{errors:o}}=k({mode:"onBlur"}),f=async c=>{r(Y(c)).unwrap().then(()=>{l(!1)}).catch(S=>{console.log(S),l(!1),j(S.error)})};return n.useEffect(()=>{a&&P("proces_v",a.id)},[a]),n.useEffect(()=>{x("")},[]),n.useEffect(()=>{t&&h({})},[t]),a?e.jsxs(e.Fragment,{children:[e.jsxs(p,{disabled:!a.is_open,size:"sm",onClick:()=>l(!t),children:[e.jsx(R,{})," Prime"]}),e.jsx(m,{show:t,size:"lg",onHide:()=>l(!1),centered:!0,"aria-labelledby":"contained-modal-title-vcenter",children:e.jsxs(s,{onSubmit:y(f),children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx("h4",{className:"card-title",children:" Create  Prime"})}),e.jsxs(m.Body,{children:[d&&e.jsx("p",{className:"text-danger",children:d}),e.jsxs(L,{children:[e.jsx(Q,{setValue:P}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3 ",children:[e.jsx(s.Label,{children:D}),e.jsxs(s.Select,{...g("prime_type",{required:"This Feild Is required"}),children:[e.jsx("option",{children:"-- Select Type--"}),i&&i.map(c=>e.jsx("option",{value:c.id,children:c.name},c.id))]}),o.prime_type&&e.jsx(s.Text,{className:"text-danger",children:o.prime_type.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:A}),e.jsx(s.Control,{type:"number",...g("montant",{required:"This Feild Is required"})}),e.jsx(v,{name:"montant",error:d}),o.montant&&e.jsx(s.Text,{className:"text-danger",children:o.montant.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:M}),e.jsx(s.Control,{type:"date",...g("date_f",{required:"This Feild Is required"})}),e.jsx(v,{name:"date_f",error:d}),o.date_f&&e.jsx(s.Text,{className:"text-danger",children:o.date_f.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:z}),e.jsx(s.Control,{type:"date",...g("date_r",{required:"This Feild Is required"})}),e.jsx(v,{name:"date_r",error:d}),o.date_r&&e.jsx(s.Text,{className:"text-danger",children:o.date_r.message})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:F}),e.jsx(s.Control,{as:"textarea",rows:3,...g("observation")}),e.jsx(v,{name:"observation",error:d}),o.observation&&e.jsx(s.Text,{className:"text-danger",children:o.observation.message})]})]})]}),e.jsxs(m.Footer,{children:[e.jsx(p,{variant:"light",onClick:()=>l(!t),children:q}),e.jsx(p,{type:"submit",children:w})]})]})})]}):null},$=({id:a,show:r,setShow:t,deleteAction:l,error:h,headertext:i,message:b})=>{console.log("render delete Prime");const x=()=>t(!1);return e.jsx(e.Fragment,{children:e.jsxs(m,{show:r,size:"sm",onHide:()=>t(!1),centered:!0,as:s,"aria-labelledby":"contained-modal-title-vcenter",children:[e.jsx(m.Header,{closeButton:!0,children:i}),e.jsxs(m.Body,{children:[h,e.jsxs("h6",{className:"card-title",children:[" ",b]})]}),e.jsxs(m.Footer,{children:[e.jsx(p,{size:"sm",variant:"light",onClick:x,children:q}),e.jsx(p,{size:"sm",variant:"danger",onClick:l,children:J})]})]})})},ve={montant:"Proces N°",observation:"This test"},Se=()=>{const a=T(I),r=C(),[t,l]=n.useState(!1),[h,i]=n.useState(),{register:b,handleSubmit:x,reset:u,formState:{errors:d}}=k({mode:"onBlur",defaultValues:ve}),j=async g=>{r(Z(g)).unwrap().then(()=>{l(!1)}).catch(y=>{console.log(y),i(y.error)})};return n.useEffect(()=>{a&&u(a)},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"mx-1",size:"sm",title:"Modifier  Proces Verbal",onClick:()=>l(!t),children:[e.jsx(W,{})," Edit"]}),e.jsxs(m,{className:"p-0 m-0",show:t,size:"lg",onHide:()=>l(!1),centered:!0,"aria-labelledby":"contained-modal-title-vcenter",children:[e.jsx(m.Header,{className:"text-danger",children:h}),e.jsx(m.Body,{className:"p-0",children:e.jsxs(_,{as:s,className:"form-vertical",onSubmit:x(j),children:[e.jsx(_.Header,{children:e.jsx("h4",{className:"card-title",children:" Modifier  Proces Verbal"})}),e.jsx(_.Body,{children:e.jsxs(L,{children:[e.jsxs(s.Group,{as:N,className:"mb-3",children:[e.jsx(s.Label,{children:X}),e.jsx(s.Check,{...b("is_open"),label:"Is open  "}),e.jsx(v,{name:"is_open",error:h}),d.is_open&&e.jsx(s.Text,{className:"text-danger",children:d.is_open.message})]}),e.jsxs(s.Group,{as:N,className:"mb-3",children:[e.jsx(s.Label,{children:"Name"}),e.jsx(s.Control,{type:"text",...b("name",{required:"This Feild Is required"})}),e.jsx(v,{name:"name",error:h}),d.name&&e.jsx(s.Text,{className:"text-danger",children:d.name.message})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:F}),e.jsx(s.Control,{as:"textarea",rows:3,...b("observation")}),e.jsx(v,{name:"observation",error:h}),d.observation&&e.jsx(s.Text,{className:"text-danger",children:d.observation.message})]})]})}),e.jsx(_.Footer,{children:e.jsx("div",{className:"col-12 d-flex justify-content-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary me-1 mb-1",children:"Submit"})})})]})})]})]})},_e=n.memo(()=>{const a=T(I),r=C(),t=T(ee),[l,h]=n.useState(!1),[i,b]=n.useState(""),[x,u]=n.useState(!1),[d,j]=n.useState(),g=()=>{a&&r(re(a.id)).then(()=>{u(!1)}).catch(E=>{j(E.error)})};n.useEffect(()=>{Object.keys(t).length===0&&h(!1)},[t]);const y=async()=>{a&&await ae({url:`${ne}primes/proces-verbal/${a.id}/excel/?date=${i}`,method:"GET",responseType:"blob"}).then(E=>{const P=window.URL.createObjectURL(E.data),o=document.createElement("a");o.href=P,o.setAttribute("download",`${a.name}.xlsx`),document.body.appendChild(o),o.click()})};return a==null?null:e.jsxs(se,{className:"justify-content-between p-0 px-2 rounded mb-2 ",style:{height:"50px",backgroundColor:"#eeeeee"},children:[e.jsx(s,{children:e.jsxs(L,{children:[e.jsxs(N,{xs:"auto",children:[e.jsx(Se,{}),e.jsx(Ne,{}),e.jsx($,{show:x,setShow:u,error:d,deleteAction:g,message:"Are you sure to delete this proces",headertext:"Delete Proces"}),e.jsxs(p,{disabled:!a.is_open,title:"Supprimer Cette Proces",className:"mx-1",size:"sm",variant:"danger",onClick:()=>u(!x),children:[e.jsx(O,{})," Suppr"]})]}),e.jsx(N,{xs:"auto",className:"d-flex  align-items-center",children:e.jsx(s.Group,{})})]})}),e.jsx(s,{}),e.jsx("div",{children:e.jsxs(p,{variant:"success",size:"sm",onClick:y,children:[e.jsx(te,{})," Excel"]})})]})}),Ee={},Pe=({primeId:a,show:r,setShow:t})=>{console.log("render edit Prime");const l=C(),[h,{data:i,isSuccess:b}]=le(),[x,{data:u,isLoading:d}]=V(),[j,g]=n.useState();n.useEffect(()=>{r&&h(a)},[a]),n.useEffect(()=>{i&&o({id:i.id,employee:i.employee.nom,proces_v:i.proces_v,prime_type:i.prime_type,date_f:i.date_f,date_r:i.date_r,montant:i.montant,observation:i.observation})},[b,i]);const{register:y,handleSubmit:E,getValues:P,reset:o,formState:{errors:f}}=k({mode:"onBlur",defaultValues:Ee}),c=async S=>{l(ie(S)).unwrap().then(()=>{t(!1)}).catch(B=>{console.log(B),g(B.error)})};return n.useEffect(()=>{r&&x({})},[r]),e.jsx(e.Fragment,{children:e.jsx(m,{show:r,size:"lg",onHide:()=>t(!1),centered:!0,"aria-labelledby":"contained-modal-title-vcenter",children:e.jsxs(s,{onSubmit:E(c),children:[e.jsx(m.Header,{}),e.jsx(m.Body,{children:e.jsxs(L,{children:[e.jsxs(s.Group,{className:"mb-3 ",children:[e.jsx(s.Label,{children:"Employee"}),e.jsx(s.Control,{disabled:!0,type:"text",value:i?i.employee.nom+" "+i.employee.prenom:""})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3 ",children:[e.jsx(s.Label,{children:D}),e.jsx(s.Select,{...y("prime_type",{required:"This Feild Is required"}),children:u&&u.map(S=>e.jsx("option",{selected:P("prime_type").name==`${S.id}`,value:S.id,children:S.name},S.id))}),f.prime_type&&e.jsx(s.Text,{className:"text-danger",children:f.prime_type.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:A}),e.jsx(s.Control,{type:"number",...y("montant",{required:"This Feild Is required"})}),e.jsx(v,{name:"montant",error:j}),f.montant&&e.jsx(s.Text,{className:"text-danger",children:f.montant.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:M}),e.jsx(s.Control,{type:"date",...y("date_f",{required:"This Feild Is required"})}),e.jsx(v,{name:"date_f",error:j}),f.date_f&&e.jsx(s.Text,{className:"text-danger",children:f.date_f.message})]}),e.jsxs(s.Group,{as:N,md:6,className:"mb-3",children:[e.jsx(s.Label,{children:z}),e.jsx(s.Control,{type:"date",...y("date_r",{required:"This Feild Is required"})}),e.jsx(v,{name:"date_r",error:j}),f.date_r&&e.jsx(s.Text,{className:"text-danger",children:f.date_r.message})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:F}),e.jsx(s.Control,{as:"textarea",rows:3,...y("observation")}),e.jsx(v,{name:"observation",error:j}),f.observation&&e.jsx(s.Text,{className:"text-danger",children:f.observation.message})]})]})}),e.jsxs(m.Footer,{children:[e.jsx(p,{variant:"light",onClick:()=>t(!r),children:q}),e.jsx(p,{type:"submit",children:w})]})]})})})},Te=()=>{const a=C(),r=T(ce),t=T(I),[l,h]=n.useState(!1),[i,b]=n.useState(!1),[x,u]=n.useState(!1),[d,j]=n.useState(),[g,{data:y}]=V(),[E,P]=n.useState();if(n.useEffect(()=>{t&&a(de({procesId:t.id})).then(()=>{h(!1)}).catch(c=>{h(!1)})},[t]),n.useEffect(()=>{g({})},[]),l)return e.jsx(oe,{});if(!r.results)return e.jsx("div",{children:" No results"});const o=n.useMemo(()=>{var c=r.results.reduce((S,B)=>Number(S)+Number(B.montant),0);return c},[r]),f=()=>{d&&a(pe(d)).then(()=>{u(!1)}).catch(c=>{P(c.error)})};return e.jsxs(_,{children:[e.jsxs(_.Header,{children:[e.jsx(Pe,{primeId:d,show:i,setShow:b}),e.jsx($,{id:d,show:x,setShow:u,deleteAction:f,error:E,headertext:"Delete Prime",message:"Are you sure to delete this Prime"})]}),e.jsx(_.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:me}),e.jsx("th",{children:xe}),e.jsx("th",{children:he}),e.jsx("th",{children:D}),e.jsx("th",{children:M}),e.jsx("th",{children:z}),e.jsx("th",{children:A}),e.jsx("th",{children:F}),e.jsx("th",{children:"ACTION"})]})}),e.jsxs("tbody",{children:[r.results&&r.results.map((c,S)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[" ",e.jsx(je,{target:"blank",to:`/employees/${c.employee.matricule}/`,children:e.jsx("small",{children:c.employee.matricule})})]}),e.jsx("td",{children:c.employee.nom}),e.jsx("td",{children:c.employee.prenom}),e.jsx("td",{children:c.prime_type.name}),e.jsx("td",{children:c.date_f}),e.jsx("td",{children:c.date_r}),e.jsx("td",{children:c.montant}),e.jsx("td",{children:c.observation}),e.jsxs("td",{children:[e.jsx(p,{disabled:!(t!=null&&t.is_open),size:"sm",onClick:()=>{j(c.id),b(!i)},children:e.jsx(ue,{})}),e.jsx(p,{disabled:!(t!=null&&t.is_open),className:"mx-1",size:"sm",variant:"danger",onClick:()=>{j(c.id),u(!x)},children:e.jsx(O,{})})]})]},c.id)),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,children:"Total"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light-success",children:o.toFixed(2)})})]})]})]})})})]})},Fe=()=>{const a=C(),r=T(be),t=l=>{a(H({proces_v:l}))};return n.useEffect(()=>{a(fe()).then(()=>{}).catch(l=>{})},[]),n.useEffect(()=>{r.length&&a(H({proces_v:r[0]}))},[r]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex align-items-start",children:e.jsxs(G,{variant:"pills",defaultActiveKey:"1",children:[(r==null?void 0:r.length)&&r.map(l=>e.jsx(G.Item,{onClick:()=>t(l),className:"rounded-0",children:e.jsx(G.Link,{className:"rounded-0",eventKey:l.id,children:l.name})})),e.jsx(ye,{})]})}),e.jsx(_,{className:"shadow-sm border border-primary rounded-0",children:e.jsx(_.Body,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{}),e.jsx(Te,{})]})})})]})};export{Fe as default};
